<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="State manager module"><title>clementine_core::states - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-1a91846b.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="clementine_core" data-themes="" data-resource-suffix="" data-rustdoc-version="1.88.0 (6b00bc388 2025-06-23)" data-channel="1.88.0" data-search-js="search-f7877310.js" data-settings-js="settings-5514c975.js" ><script src="../../static.files/storage-4e99c027.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-7ef8a74a.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../clementine_core/index.html">clementine_<wbr>core</a><span class="version">0.4.2</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module states</a></h2><h3><a href="#reexports">Module Items</a></h3><ul class="block"><li><a href="#reexports" title="Re-exports">Re-exports</a></li><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#traits" title="Traits">Traits</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate clementine_<wbr>core</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">clementine_core</a></div><h1>Module <span>states</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/clementine_core/states/mod.rs.html#1-657">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>State manager module</p>
<p>This module contains the state manager, which is responsible for holding the state machines
of the system representing the current operator state for each operator, and kickoff state for each kickoff
(Each operator and kickoff process has its own state machine).</p>
<p>The main responsibility of the state manager is to process each finalized block in Bitcoin and update the state machines.
The blocks are scanned for relevant Clementine txâ€™s and internal state of the state machines is updated. This relevant data
is passed on verifiers/operators when its time to send bridge transactions (like operator asserts, watchtower challenges, etc).</p>
<p>Operator state machine: Stores where in the collateral chain the operator is. (Which round or ready to reimburse tx)
Additionally during rounds it stores which kickoff utxos of the round are spent.
Kickoff state machine:
- Stores if the kickoff was challenged.
- Stores/tracks watchtower challenges, latest blockhash commit by operator, operator asserts, any relevant information needed
for proving and disproving the kickoff.</p>
<p>For state machines we use the <a href="https://github.com/mdeloof/statig">statig</a> crate.</p>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">Â§</a></h2><dl class="item-table reexports"><dt id="reexport.block_cache"><code>pub use crate::builder::<a class="mod" href="../builder/block_cache/index.html" title="mod clementine_core::builder::block_cache">block_cache</a>;</code></dt><dt id="reexport.Duty"><code>pub use context::<a class="enum" href="context/enum.Duty.html" title="enum clementine_core::states::context::Duty">Duty</a>;</code></dt><dt id="reexport.Owner"><code>pub use context::<a class="trait" href="context/trait.Owner.html" title="trait clementine_core::states::context::Owner">Owner</a>;</code></dt></dl><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="mod" href="context/index.html" title="mod clementine_core::states::context">context</a></dt><dt><a class="mod" href="event/index.html" title="mod clementine_core::states::event">event</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="mod" href="kickoff/index.html" title="mod clementine_core::states::kickoff">kickoff</a></dt><dt><a class="mod" href="matcher/index.html" title="mod clementine_core::states::matcher">matcher</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="mod" href="round/index.html" title="mod clementine_core::states::round">round</a></dt><dt><a class="mod" href="task/index.html" title="mod clementine_core::states::task">task</a></dt></dl><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.StateManager.html" title="struct clementine_core::states::StateManager">State<wbr>Manager</a></dt><dd>State manager stores the state machines.
It is responsible for following:
- Persisting current state of the state machines to the database.
- Collecting new <a href="enum.SystemEvent.html" title="enum clementine_core::states::SystemEvent"><code>SystemEvent</code></a>s from the message queue and passing them to the state machines,
thus updating the state machines.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.ContextProcessResult.html" title="enum clementine_core::states::ContextProcessResult">Context<wbr>Process<wbr>Result</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dt><a class="enum" href="enum.StateMachineError.html" title="enum clementine_core::states::StateMachineError">State<wbr>Machine<wbr>Error</a></dt><dt><a class="enum" href="enum.SystemEvent.html" title="enum clementine_core::states::SystemEvent">System<wbr>Event</a></dt><dd>System events are events that are sent by other parts of clementine to the state machine
They are used to update the state machine
They are sent by the state manager to the state machine</dd></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">Â§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.ContextProcessor.html" title="trait clementine_core::states::ContextProcessor">Context<wbr>Processor</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </dt><dd>Utility trait to make processing generic</dd></dl></section></div></main></body></html>